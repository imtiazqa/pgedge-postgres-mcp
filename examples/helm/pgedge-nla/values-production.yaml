# Production configuration example
# Usage: helm install pgedge-nla ./pgedge-nla -f values-production.yaml

server:
  replicaCount: 3

  resources:
    limits:
      cpu: 2000m
      memory: 2Gi
    requests:
      cpu: 1000m
      memory: 1Gi

  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80

  persistence:
    enabled: true
    size: 5Gi
    storageClass: fast-ssd

  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchExpressions:
            - key: app.kubernetes.io/component
              operator: In
              values:
              - server
          topologyKey: kubernetes.io/hostname

web:
  replicaCount: 3

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 8

  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchExpressions:
            - key: app.kubernetes.io/component
              operator: In
              values:
              - web
          topologyKey: kubernetes.io/hostname

ingress:
  enabled: true
  className: nginx
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
    nginx.ingress.kubernetes.io/proxy-body-size: "10m"
    nginx.ingress.kubernetes.io/proxy-connect-timeout: "90"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "90"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "90"
    nginx.ingress.kubernetes.io/rate-limit: "100"
  hosts:
    - host: nla.production.example.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: pgedge-nla-production-tls
      hosts:
        - nla.production.example.com

secrets:
  postgresPassword: "production-secure-password"
  anthropicApiKey: "sk-ant-..."
  openaiApiKey: "sk-..."
